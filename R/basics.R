#----------------------------------------------------------------------------------------------------
# Basic epi
#----------------------------------------------------------------------------------------------------

logit <- function(x, tol=1e-4){
  return( log(((x+tol)/(1-x+tol))) )
}

expit <- function(x, tol=1e-4){
  return( 1/(1+exp(-x + tol)) )
}

#----------------------------------------------------------------------------------------------------
# Change return from scale
#----------------------------------------------------------------------------------------------------
my.scale <- function(x, ...){
  ret <- scale(x, ...)
  if(ncol(ret) == 1){
    return(as.numeric(ret)) # coerce matrix of 1 col to numeric vector
  } else{
    stop("Matrix has more than one column")
  }
}
